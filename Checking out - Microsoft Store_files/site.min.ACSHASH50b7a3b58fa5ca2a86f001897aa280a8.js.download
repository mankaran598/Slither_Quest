'use strict';!function(){function E(y){if(G[y])return G[y].exports;var a=G[y]={exports:{}};return M[y].call(a.exports,a,a.exports,E),a.exports}var K,C,L,F,M={1737:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.buyNowUIUrlPath=a.purchaseUIUrlPath=void 0;var u=r(1121);a.purchaseUIUrlPath=function(q,n,b){return"ppe"===(null==q?void 0:q.selectEnv)||n&&0<n.length&&n.map(function(c){return c.toLowerCase()}).includes(u.ppeFlightName)||b&&0<b.length&&b.map(function(c){return c.toLowerCase()}).includes(u.ppeFlightName)?
u.PPE_PURCHASEUI_URL:u.BASE_PURCHASEUI_URL};a.buyNowUIUrlPath=function(q,n,b){return"ppe"===(null==q?void 0:q.selectEnv)||n&&0<n.length&&n.map(function(c){return c.toLowerCase()}).includes(u.ppeFlightName)||b&&0<b.length&&b.map(function(c){return c.toLowerCase()}).includes(u.ppeFlightName)?u.PPE_BUYNOWUI_URL:u.BASE_BUYNOWUI_URL}},5937:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.getPrefetchUrlByRoute=a.getPrefetchUrl=a.addingQueryParams=a.createInputForArray=a.extraData=a.createInput=
void 0;var u=r(1121);a.createInput=function(q,n,b){var c=document.createElement("input");return c.name=q,c.type="hidden",c.value=n?JSON.stringify(n):null!=b?b:"",c};a.extraData=function(q){return{usePurchaseSdk:!0,clientType:q}};a.createInputForArray=function(q,n,b){if(q&&b&&0<(null==b?void 0:b.length)){var c=0;b.forEach(function(d){q.appendChild((0,a.createInput)(n+"["+c+"]",void 0,d));c++})}};a.addingQueryParams=function(q,n){return n&&0<n.length?-1<(null==q?void 0:q.indexOf("?"))?q+"\x26"+n:q+
"?"+n:q};a.getPrefetchUrl=function(q,n){var b=new URLSearchParams;return n?(n.market&&b.append("market",n.market),n.locale&&b.append("locale",n.locale),n.clientType&&b.append("clientType",n.clientType),n.cssOverride&&b.append("cssOverride",n.cssOverride),n.optionalAssets&&b.append("optional",n.optionalAssets),(0,a.addingQueryParams)(q,b.toString())):q};a.getPrefetchUrlByRoute=function(q){return-1<q.indexOf("cart")||-1<q.indexOf("checkout")?u.prefetchURLTemplate.replace("{0}",u.purchaseUIAppName).replace("{1}",
q):u.prefetchURLTemplate.replace("{0}",u.buyNowUIAppName).replace("{1}",q)}},8399:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.getTimeToInvokeMarkFromArgsOrNewMetric=a.getTimeToInvokeMark=a.clearPerfMarks=void 0;a.clearPerfMarks=function(){performance&&performance.clearMarks&&performance.clearMarks()};a.getTimeToInvokeMark=function(r){performance&&performance.mark&&performance.mark(r);r=performance&&performance.getEntriesByName?performance.getEntriesByName(r):[];return 0<r.length?
r[0].startTime:-1};a.getTimeToInvokeMarkFromArgsOrNewMetric=function(r,u){return u&&0<u?u:(0,a.getTimeToInvokeMark)(r)}},6063:function(y,a,r){var u=this&&this.__awaiter||function(d,f,g,e){return new (g||(g=Promise))(function(p,h){function m(t){try{w(e.next(t))}catch(k){h(k)}}function l(t){try{w(e.throw(t))}catch(k){h(k)}}function w(t){var k;t.done?p(t.value):(k=t.value,k instanceof g?k:new g(function(x){x(k)})).then(m,l)}w((e=e.apply(d,f||[])).next())})},q=this&&this.__generator||function(d,f){function g(w){return function(t){return function(k){if(e)throw new TypeError("Generator is already executing.");
for(;l;)try{if(e=1,p&&(h=2&k[0]?p.return:k[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,k[1])).done)return h;switch(p=0,h&&(k=[2&k[0],h.value]),k[0]){case 0:case 1:h=k;break;case 4:return l.label++,{value:k[1],done:!1};case 5:l.label++;p=k[1];k=[0];continue;case 7:k=l.ops.pop();l.trys.pop();continue;default:if(!((h=0<(h=l.trys).length&&h[h.length-1])||6!==k[0]&&2!==k[0])){l=0;continue}if(3===k[0]&&(!h||k[1]>h[0]&&k[1]<h[3]))l.label=k[1];else if(6===k[0]&&l.label<h[1])l.label=h[1],
h=k;else if(h&&l.label<h[2])l.label=h[2],l.ops.push(k);else{h[2]&&l.ops.pop();l.trys.pop();continue}}k=f.call(d,l)}catch(x){k=[6,x],p=0}finally{e=h=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([w,t])}}var e,p,h,m,l={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return m={next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m};Object.defineProperty(a,"__esModule",{value:!0});a.invokeAADSignInInFrame=
void 0;var n=r(8399),b=r(6929),c=r(6813);a.invokeAADSignInInFrame=function(d,f){var g,e;return u(this,void 0,void 0,function(){var p;return q(this,function(h){switch(h.label){case 0:if(!d.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');return(p=document.createElement("form")).target=d.name,p.action=(0,b.constructCartURl)(),p.method="post",(0,b.createInputForPurchaseUI)(p,{isHosted:null===(g=f.isHosted)||void 0===g||g,canvasType:null!==(e=f.canvasType)&&void 0!==
e?e:"web",GPC_DataSharingOptIn:f.GPC_DataSharingOptIn,timeToInvokeIframe:(0,n.getTimeToInvokeMarkFromArgsOrNewMetric)("aadSignInInvoke",f.timeToInvokeIframe),sdkVersion:c.LIB_VERSION}),d.appendChild(p),p.submit(),[4,(0,b.attachingMessageHandler)(p)];case 1:return h.sent(),[2,!0]}})})}},6929:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.attachingMessageHandler=a.createInputForPurchaseUI=a.constructCartURl=void 0;var u=r(5937),q=r(1121);a.constructCartURl=function(){return""+q.TARGET_ORIGIN+
q.BASE_PURCHASEUI_URL+q.appRoutes.aadSignIn+"?pageFormat\x3dfull"};a.createInputForPurchaseUI=function(n,b){Object.keys(b).forEach(function(c){if(c&&b[c]){var d=b[c];n.appendChild((0,u.createInput)(c,void 0,d))}else c&&c===q.GPC_DataSharingOptInKey&&(d=b[c],n.appendChild((0,u.createInput)(c,void 0,d)))})};a.attachingMessageHandler=function(n){return new Promise(function(b){return window.addEventListener("message",function(c){c.origin===q.TARGET_ORIGIN&&("ReactPurchaseReadyToRender"===c.data&&b(),
n&&n.remove())},!0)})}},1228:function(y,a,r){var u=this&&this.__awaiter||function(d,f,g,e){return new (g||(g=Promise))(function(p,h){function m(t){try{w(e.next(t))}catch(k){h(k)}}function l(t){try{w(e.throw(t))}catch(k){h(k)}}function w(t){var k;t.done?p(t.value):(k=t.value,k instanceof g?k:new g(function(x){x(k)})).then(m,l)}w((e=e.apply(d,f||[])).next())})},q=this&&this.__generator||function(d,f){function g(w){return function(t){return function(k){if(e)throw new TypeError("Generator is already executing.");
for(;l;)try{if(e=1,p&&(h=2&k[0]?p.return:k[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,k[1])).done)return h;switch(p=0,h&&(k=[2&k[0],h.value]),k[0]){case 0:case 1:h=k;break;case 4:return l.label++,{value:k[1],done:!1};case 5:l.label++;p=k[1];k=[0];continue;case 7:k=l.ops.pop();l.trys.pop();continue;default:if(!((h=0<(h=l.trys).length&&h[h.length-1])||6!==k[0]&&2!==k[0])){l=0;continue}if(3===k[0]&&(!h||k[1]>h[0]&&k[1]<h[3]))l.label=k[1];else if(6===k[0]&&l.label<h[1])l.label=h[1],
h=k;else if(h&&l.label<h[2])l.label=h[2],l.ops.push(k);else{h[2]&&l.ops.pop();l.trys.pop();continue}}k=f.call(d,l)}catch(x){k=[6,x],p=0}finally{e=h=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([w,t])}}var e,p,h,m,l={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return m={next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m};Object.defineProperty(a,"__esModule",{value:!0});a.invokeCheckoutInFrame=void 0;
var n=r(8399),b=r(8064),c=r(6813);a.invokeCheckoutInFrame=function(d,f){var g,e;return u(this,void 0,void 0,function(){var p;return q(this,function(h){switch(h.label){case 0:if(!d.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');return(p=document.createElement("form")).target=d.name,p.action=(0,b.constructOrderLookupURl)(f),p.method="post",(0,b.createInputForPurchaseUI)(p,{authToken:f.authToken,market:f.market,cV:encodeURIComponent(f.cV),data:(0,b.externalData)(f),
locale:f.locale,clientType:f.clientType,layout:f.layout,cssOverride:f.cssOverride,theme:f.theme,hostRedirectReturnUrlTemplate:f.hostRedirectReturnUrlTemplate,muid:f.muid,keepShoppingUrl:f.keepShoppingUrl,aveSuccessRedirectUrl:f.aveSuccessRedirectUrl,aveFailureRedirectUrl:f.aveFailureRedirectUrl,postBusyStateToParent:f.postBusyStateToParent,postCartCountToParent:f.postCartCountToParent,productImageBackgroundColorARGB:f.productImageBackgroundColorARGB,pageFormat:f.pageFormat||"full",isHosted:null===
(g=f.isHosted)||void 0===g||g,canvasType:null!==(e=f.canvasType)&&void 0!==e?e:"web",alternativeMuid:f.alternativeMuid,bearerToken:f.bearerToken,flights:f.flights,corpAccessToken:f.corpAccessToken,billingAccountId:f.billingAccountId,pidlBearerToken:f.pidlBearerToken,clientHandleUrl:!0,experiments:f.experiments,timeToInvokeIframe:(0,n.getTimeToInvokeMarkFromArgsOrNewMetric)("orderLookUpInvoke",f.timeToInvokeIframe),sdkVersion:c.LIB_VERSION}),d.appendChild(p),p.submit(),[4,(0,b.attachingMessageHandler)(p)];
case 1:return h.sent(),[2,!0]}})})}},8064:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.externalData=a.createInputForPurchaseUI=a.attachingMessageHandler=a.constructOrderLookupURl=void 0;var u=r(5937),q=r(1121),n=r(1737);a.constructOrderLookupURl=function(b){var c=""+q.TARGET_ORIGIN+(0,n.purchaseUIUrlPath)(b,b.flights)+q.appRoutes.commercialCheckout;if(!b.clientType)throw Error("purchase-sdk: clientType is missing !!!");return c=c+"?client\x3d"+b.clientType,(0,u.addingQueryParams)(c,
b.queryStringParams)};a.attachingMessageHandler=function(b){return new Promise(function(c){return window.addEventListener("message",function(d){d.origin===q.TARGET_ORIGIN&&("ReactPurchaseReadyToRender"===d.data&&c(),b&&b.remove())},!0)})};a.createInputForPurchaseUI=function(b,c){Object.keys(c).forEach(function(d){if(d&&c[d])if("authToken"===d)b.appendChild((0,u.createInput)("msaTicket",void 0,c.authToken));else if("data"===d)b.appendChild((0,u.createInput)("data",c.data));else if("flights"===d)(0,
u.createInputForArray)(b,"flights",c.flights);else if("experiments"===d)(0,u.createInputForArray)(b,"experiments",c.experiments);else{var f=c[d];b.appendChild((0,u.createInput)(d,void 0,f))}else d&&d===q.GPC_DataSharingOptInKey&&(f=c[d],b.appendChild((0,u.createInput)(d,void 0,f)))})};a.externalData=function(b){var c,d,f,g,e,p;return{usePurchaseSdk:!0,postCartCountToParent:null==b?void 0:b.postCartCountToParent,postBusyStateToParent:null==b?void 0:b.postBusyStateToParent,keepShoppingUrl:null==b?void 0:
b.keepShoppingUrl,aveSuccessRedirectUrl:null==b?void 0:b.aveSuccessRedirectUrl,aveFailureRedirectUrl:null==b?void 0:b.aveFailureRedirectUrl,hostRedirectReturnUrlTemplate:null==b?void 0:b.hostRedirectReturnUrlTemplate,clientType:null===(c=null==b?void 0:b.data)||void 0===c?void 0:c.clientType,addPiSuccessUrl:null===(d=null==b?void 0:b.data)||void 0===d?void 0:d.addPiSuccessUrl,addPiFailureUrl:null===(f=null==b?void 0:b.data)||void 0===f?void 0:f.addPiFailureUrl,layout:null===(g=null==b?void 0:b.data)||
void 0===g?void 0:g.layout,cssOverride:null===(e=null==b?void 0:b.data)||void 0===e?void 0:e.cssOverride,data:null===(p=null==b?void 0:b.data)||void 0===p?void 0:p.data}}},5465:function(y,a,r){var u=this&&this.__awaiter||function(g,e,p,h){return new (p||(p=Promise))(function(m,l){function w(x){try{k(h.next(x))}catch(v){l(v)}}function t(x){try{k(h.throw(x))}catch(v){l(v)}}function k(x){var v;x.done?m(x.value):(v=x.value,v instanceof p?v:new p(function(A){A(v)})).then(w,t)}k((h=h.apply(g,e||[])).next())})},
q=this&&this.__generator||function(g,e){function p(k){return function(x){return function(v){if(h)throw new TypeError("Generator is already executing.");for(;t;)try{if(h=1,m&&(l=2&v[0]?m.return:v[0]?m.throw||((l=m.return)&&l.call(m),0):m.next)&&!(l=l.call(m,v[1])).done)return l;switch(m=0,l&&(v=[2&v[0],l.value]),v[0]){case 0:case 1:l=v;break;case 4:return t.label++,{value:v[1],done:!1};case 5:t.label++;m=v[1];v=[0];continue;case 7:v=t.ops.pop();t.trys.pop();continue;default:if(!((l=0<(l=t.trys).length&&
l[l.length-1])||6!==v[0]&&2!==v[0])){t=0;continue}if(3===v[0]&&(!l||v[1]>l[0]&&v[1]<l[3]))t.label=v[1];else if(6===v[0]&&t.label<l[1])t.label=l[1],l=v;else if(l&&t.label<l[2])t.label=l[2],t.ops.push(v);else{l[2]&&t.ops.pop();t.trys.pop();continue}}v=e.call(g,t)}catch(A){v=[6,A],m=0}finally{h=l=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([k,x])}}var h,m,l,w,t={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return w={next:p(0),throw:p(1),return:p(2)},"function"==
typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w};Object.defineProperty(a,"__esModule",{value:!0});a.prefetchCart=a.makeWindowListener=a.invokeCartInFrame=void 0;var n=r(5937),b=r(8399),c=r(1121),d=r(4310),f=r(6813);a.invokeCartInFrame=function(g,e){var p,h;return u(this,void 0,void 0,function(){var m;return q(this,function(l){switch(l.label){case 0:if(!g.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');return(m=document.createElement("form")).target=
g.name,m.action=(0,d.constructCartURl)(e),m.method="post",(0,d.createInputForPurchaseUI)(m,{market:e.market,cV:encodeURIComponent(e.cV),data:(0,d.externalData)(e),locale:e.locale,clientType:e.clientType,layout:e.layout,cssOverride:e.cssOverride,theme:e.theme,hostRedirectReturnUrlTemplate:e.hostRedirectReturnUrlTemplate,muid:e.muid,keepShoppingUrl:e.keepShoppingUrl,aveSuccessRedirectUrl:e.aveSuccessRedirectUrl,aveFailureRedirectUrl:e.aveFailureRedirectUrl,postBusyStateToParent:e.postBusyStateToParent,
postCartCountToParent:e.postCartCountToParent,productImageBackgroundColorARGB:e.productImageBackgroundColorARGB,pageFormat:e.pageFormat||"full",authToken:e.authToken,xToken:e.xToken,isHosted:null===(p=e.isHosted)||void 0===p||p,canvasType:null!==(h=e.canvasType)&&void 0!==h?h:"web",alternativeMuid:e.alternativeMuid,bearerToken:e.bearerToken,flights:e.flights,corpAccessToken:e.corpAccessToken,billingAccountId:e.billingAccountId,pidlBearerToken:e.pidlBearerToken,clientHandleUrl:!0,GPC_DataSharingOptIn:e.GPC_DataSharingOptIn,
queryStringParams:e.queryStringParams,experiments:e.experiments,timeToInvokeIframe:(0,b.getTimeToInvokeMarkFromArgsOrNewMetric)("cartInvoke",e.timeToInvokeIframe),sdkVersion:f.LIB_VERSION}),g.appendChild(m),m.submit(),[4,(0,d.attachingMessageHandler)(m)];case 1:return l.sent(),[2,!0]}})})};a.makeWindowListener=function(g){return function(e){var p,h,m,l,w,t,k,x;if(e.origin===c.TARGET_ORIGIN)switch(e=e.data,null==e?void 0:e.message){case "cartStatus":null===(p=g.cartStatus)||void 0===p||p.call(g,e);
break;case "done":g.done(e);break;case "stageChanged":null===(h=g.stageChanged)||void 0===h||h.call(g,e);break;case "status":null===(m=g.status)||void 0===m||m.call(g,e);break;case "sizeChanged":null===(l=g.sizeChanged)||void 0===l||l.call(g,e);break;case "resize":null===(w=g.resize)||void 0===w||w.call(g,e);break;case "ready":null===(t=g.ready)||void 0===t||t.call(g,e);break;case "checkout":null===(k=g.checkout)||void 0===k||k.call(g,e);break;case "openUrl":null===(x=g.openUrl)||void 0===x||x.call(g,
e)}}};a.prefetchCart=function(g){g.src=(0,n.getPrefetchUrlByRoute)(c.appRoutes.cart)}},4310:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.externalData=a.createInputForPurchaseUI=a.attachingMessageHandler=a.constructCartURl=void 0;var u=r(1737),q=r(5937),n=r(1121);a.constructCartURl=function(b){var c=""+n.TARGET_ORIGIN+(0,u.purchaseUIUrlPath)(b,b.flights)+n.appRoutes.cart;if(!b.clientType)throw Error("purchase-sdk: clientType is missing !!!");return c=c+"?client\x3d"+b.clientType,
(0,q.addingQueryParams)(c,b.queryStringParams)};a.attachingMessageHandler=function(b){return new Promise(function(c){return window.addEventListener("message",function(d){d.origin===n.TARGET_ORIGIN&&("ReactPurchaseReadyToRender"===d.data&&c(),b&&b.remove())},!0)})};a.createInputForPurchaseUI=function(b,c){Object.keys(c).forEach(function(d){if(d&&c[d])if("authToken"===d)b.appendChild((0,q.createInput)("msaTicket",void 0,c.authToken));else if("data"===d)b.appendChild((0,q.createInput)("data",c.data));
else if("flights"===d)(0,q.createInputForArray)(b,"flights",c.flights);else if("experiments"===d)(0,q.createInputForArray)(b,"experiments",c.experiments);else{var f=c[d];b.appendChild((0,q.createInput)(d,void 0,f))}else d&&d===n.GPC_DataSharingOptInKey&&(f=c[d],b.appendChild((0,q.createInput)(d,void 0,f)))})};a.externalData=function(b){var c,d,f,g,e,p;return{usePurchaseSdk:!0,postCartCountToParent:null==b?void 0:b.postCartCountToParent,postBusyStateToParent:null==b?void 0:b.postBusyStateToParent,
keepShoppingUrl:null==b?void 0:b.keepShoppingUrl,aveSuccessRedirectUrl:null==b?void 0:b.aveSuccessRedirectUrl,aveFailureRedirectUrl:null==b?void 0:b.aveFailureRedirectUrl,hostRedirectReturnUrlTemplate:null==b?void 0:b.hostRedirectReturnUrlTemplate,clientType:null===(c=null==b?void 0:b.data)||void 0===c?void 0:c.clientType,addPiSuccessUrl:null===(d=null==b?void 0:b.data)||void 0===d?void 0:d.addPiSuccessUrl,addPiFailureUrl:null===(f=null==b?void 0:b.data)||void 0===f?void 0:f.addPiFailureUrl,layout:null===
(g=null==b?void 0:b.data)||void 0===g?void 0:g.layout,cssOverride:null===(e=null==b?void 0:b.data)||void 0===e?void 0:e.cssOverride,data:null===(p=null==b?void 0:b.data)||void 0===p?void 0:p.data}}},5659:function(y,a,r){var u=this&&this.__awaiter||function(g,e,p,h){return new (p||(p=Promise))(function(m,l){function w(x){try{k(h.next(x))}catch(v){l(v)}}function t(x){try{k(h.throw(x))}catch(v){l(v)}}function k(x){var v;x.done?m(x.value):(v=x.value,v instanceof p?v:new p(function(A){A(v)})).then(w,t)}
k((h=h.apply(g,e||[])).next())})},q=this&&this.__generator||function(g,e){function p(k){return function(x){return function(v){if(h)throw new TypeError("Generator is already executing.");for(;t;)try{if(h=1,m&&(l=2&v[0]?m.return:v[0]?m.throw||((l=m.return)&&l.call(m),0):m.next)&&!(l=l.call(m,v[1])).done)return l;switch(m=0,l&&(v=[2&v[0],l.value]),v[0]){case 0:case 1:l=v;break;case 4:return t.label++,{value:v[1],done:!1};case 5:t.label++;m=v[1];v=[0];continue;case 7:v=t.ops.pop();t.trys.pop();continue;
default:if(!((l=0<(l=t.trys).length&&l[l.length-1])||6!==v[0]&&2!==v[0])){t=0;continue}if(3===v[0]&&(!l||v[1]>l[0]&&v[1]<l[3]))t.label=v[1];else if(6===v[0]&&t.label<l[1])t.label=l[1],l=v;else if(l&&t.label<l[2])t.label=l[2],t.ops.push(v);else{l[2]&&t.ops.pop();t.trys.pop();continue}}v=e.call(g,t)}catch(A){v=[6,A],m=0}finally{h=l=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([k,x])}}var h,m,l,w,t={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return w=
{next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w};Object.defineProperty(a,"__esModule",{value:!0});a.prefetchCheckout=a.makeWindowListener=a.invokeDeviceRepairInFrame=a.invokeCheckoutInFrame=void 0;var n=r(5937),b=r(8399),c=r(1121),d=r(4997),f=r(6813);a.invokeCheckoutInFrame=function(g,e){var p,h;return u(this,void 0,void 0,function(){var m;return q(this,function(l){switch(l.label){case 0:if(!g.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');
return(m=document.createElement("form")).target=g.name,m.action=(0,d.constructCheckoutURl)(e),m.method="post",(0,d.createInputForCheckout)(m,{market:e.market,cV:encodeURIComponent(e.cV),data:(0,d.externalData)(e),locale:e.locale,clientType:e.clientType,layout:e.layout,cssOverride:e.cssOverride,theme:e.theme,hostRedirectReturnUrlTemplate:e.hostRedirectReturnUrlTemplate,muid:e.muid,keepShoppingUrl:e.keepShoppingUrl,postBusyStateToParent:e.postBusyStateToParent,productImageBackgroundColorARGB:e.productImageBackgroundColorARGB,
pageFormat:e.pageFormat||"full",authToken:e.authToken,xToken:e.xToken,isHosted:null===(p=e.isHosted)||void 0===p||p,canvasType:null!==(h=e.canvasType)&&void 0!==h?h:"web",alternativeMuid:e.alternativeMuid,bearerToken:e.bearerToken,flights:e.flights,corpAccessToken:e.corpAccessToken,billingAccountId:e.billingAccountId,pidlBearerToken:e.pidlBearerToken,clientHandleUrl:!0,GPC_DataSharingOptIn:e.GPC_DataSharingOptIn,queryStringParams:e.queryStringParams,experiments:e.experiments,timeToInvokeIframe:(0,
b.getTimeToInvokeMarkFromArgsOrNewMetric)("checkoutInvoke",e.timeToInvokeIframe),sdkVersion:f.LIB_VERSION}),g.appendChild(m),m.submit(),[4,(0,d.attachingMessageHandler)(m)];case 1:return l.sent(),[2,!0]}})})};a.invokeDeviceRepairInFrame=function(g,e){var p,h;return u(this,void 0,void 0,function(){var m;return q(this,function(l){switch(l.label){case 0:if(!g.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');return(m=document.createElement("form")).target=g.name,m.action=
(0,d.constructDeviceRepairURl)(e),m.method="post",(0,d.createInputForDeviceRepair)(m,{market:e.market,cV:encodeURIComponent(e.cV),data:(0,d.externalData)(e),locale:e.locale,cartId:e.cartId,clientType:e.clientType,layout:e.layout,cssOverride:e.cssOverride,theme:e.theme,hostRedirectReturnUrlTemplate:e.hostRedirectReturnUrlTemplate,muid:e.muid,postBusyStateToParent:e.postBusyStateToParent,pageFormat:e.pageFormat||"full",authToken:e.authToken,isHosted:null===(p=e.isHosted)||void 0===p||p,canvasType:null!==
(h=e.canvasType)&&void 0!==h?h:"web",GPC_DataSharingOptIn:e.GPC_DataSharingOptIn,queryStringParams:e.queryStringParams,experiments:e.experiments,flights:e.flights,sdkVersion:f.LIB_VERSION}),g.appendChild(m),m.submit(),[4,(0,d.attachingMessageHandler)(m)];case 1:return l.sent(),[2,!0]}})})};a.makeWindowListener=function(g){return function(e){var p,h,m,l,w,t,k;if(e.origin===c.TARGET_ORIGIN)switch(e=e.data,null==e?void 0:e.message){case "checkoutStatus":null===(p=g.checkoutStatus)||void 0===p||p.call(g,
e);break;case "done":g.done(e);break;case "stageChanged":null===(h=g.stageChanged)||void 0===h||h.call(g,e);break;case "status":null===(m=g.status)||void 0===m||m.call(g,e);break;case "sizeChanged":null===(l=g.sizeChanged)||void 0===l||l.call(g,e);break;case "resize":null===(w=g.resize)||void 0===w||w.call(g,e);break;case "ready":null===(t=g.ready)||void 0===t||t.call(g,e);break;case "openUrl":null===(k=g.openUrl)||void 0===k||k.call(g,e)}}};a.prefetchCheckout=function(g){g.src=(0,n.getPrefetchUrlByRoute)(c.appRoutes.checkout)}},
4997:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.externalData=a.constructDeviceRepairURl=a.constructCheckoutURl=a.createInputForDeviceRepair=a.createInputForCheckout=a.attachingMessageHandler=void 0;var u=r(1737),q=r(5937),n=r(1121);a.attachingMessageHandler=function(b){return new Promise(function(c){return window.addEventListener("message",function(d){d.origin===n.TARGET_ORIGIN&&("ReactPurchaseReadyToRender"===d.data&&c(),b&&b.remove())},!0)})};a.createInputForCheckout=function(b,
c){Object.keys(c).forEach(function(d){if(d&&c[d])if("authToken"===d)b.appendChild((0,q.createInput)("msaTicket",void 0,c.authToken));else if("data"===d)b.appendChild((0,q.createInput)("data",c.data));else if("flights"===d)(0,q.createInputForArray)(b,"flights",c.flights);else if("experiments"===d)(0,q.createInputForArray)(b,"experiments",c.experiments);else{var f=c[d];b.appendChild((0,q.createInput)(d,void 0,f))}else d&&d===n.GPC_DataSharingOptInKey&&(f=c[d],b.appendChild((0,q.createInput)(d,void 0,
f)))})};a.createInputForDeviceRepair=function(b,c){Object.keys(c).forEach(function(d){if(d&&c[d])if("authToken"===d)b.appendChild((0,q.createInput)("msaTicket",void 0,c.authToken));else if("data"===d)b.appendChild((0,q.createInput)("data",c.data));else if("flights"===d)(0,q.createInputForArray)(b,"flights",c.flights);else if("experiments"===d)(0,q.createInputForArray)(b,"experiments",c.experiments);else{var f=c[d];b.appendChild((0,q.createInput)(d,void 0,f))}else d&&d===n.GPC_DataSharingOptInKey&&
(f=c[d],b.appendChild((0,q.createInput)(d,void 0,f)))})};a.constructCheckoutURl=function(b){var c=""+n.TARGET_ORIGIN+(0,u.purchaseUIUrlPath)(b,b.flights)+n.appRoutes.checkout;if(!b.authToken&&!b.xToken)throw Error("purchase-sdk: Authentication token is missing !!!");if(!b.clientType)throw Error("purchase-sdk: clientType is missing !!!");return c=c+"?client\x3d"+b.clientType,(0,q.addingQueryParams)(c,b.queryStringParams)};a.constructDeviceRepairURl=function(b){var c=""+n.TARGET_ORIGIN+(0,u.purchaseUIUrlPath)(b,
b.flights)+n.appRoutes.deviceRepair;if(!b.authToken)throw Error("purchase-sdk: authToken is missing !!!");if(!b.cartId)throw Error("purchase-sdk: order id is missing !!!");if(!b.clientType)throw Error("purchase-sdk: clientType is missing !!!");return c+"?client\x3d"+b.clientType};a.externalData=function(b){var c,d,f,g,e,p;return{usePurchaseSdk:!0,postBusyStateToParent:null==b?void 0:b.postBusyStateToParent,keepShoppingUrl:null==b?void 0:b.keepShoppingUrl,aveSuccessRedirectUrl:null==b?void 0:b.aveSuccessRedirectUrl,
aveFailureRedirectUrl:null==b?void 0:b.aveFailureRedirectUrl,hostRedirectReturnUrlTemplate:null==b?void 0:b.hostRedirectReturnUrlTemplate,clientType:null===(c=null==b?void 0:b.data)||void 0===c?void 0:c.clientType,addPiSuccessUrl:null===(d=null==b?void 0:b.data)||void 0===d?void 0:d.addPiSuccessUrl,addPiFailureUrl:null===(f=null==b?void 0:b.data)||void 0===f?void 0:f.addPiFailureUrl,layout:null===(g=null==b?void 0:b.data)||void 0===g?void 0:g.layout,cssOverride:null===(e=null==b?void 0:b.data)||void 0===
e?void 0:e.cssOverride,data:null===(p=null==b?void 0:b.data)||void 0===p?void 0:p.data,postCartCountToParent:null==b?void 0:b.postCartCountToParent}}},5708:function(y,a,r){var u=this&&this.__awaiter||function(f,g,e,p){return new (e||(e=Promise))(function(h,m){function l(k){try{t(p.next(k))}catch(x){m(x)}}function w(k){try{t(p.throw(k))}catch(x){m(x)}}function t(k){var x;k.done?h(k.value):(x=k.value,x instanceof e?x:new e(function(v){v(x)})).then(l,w)}t((p=p.apply(f,g||[])).next())})},q=this&&this.__generator||
function(f,g){function e(t){return function(k){return function(x){if(p)throw new TypeError("Generator is already executing.");for(;w;)try{if(p=1,h&&(m=2&x[0]?h.return:x[0]?h.throw||((m=h.return)&&m.call(h),0):h.next)&&!(m=m.call(h,x[1])).done)return m;switch(h=0,m&&(x=[2&x[0],m.value]),x[0]){case 0:case 1:m=x;break;case 4:return w.label++,{value:x[1],done:!1};case 5:w.label++;h=x[1];x=[0];continue;case 7:x=w.ops.pop();w.trys.pop();continue;default:if(!((m=0<(m=w.trys).length&&m[m.length-1])||6!==
x[0]&&2!==x[0])){w=0;continue}if(3===x[0]&&(!m||x[1]>m[0]&&x[1]<m[3]))w.label=x[1];else if(6===x[0]&&w.label<m[1])w.label=m[1],m=x;else if(m&&w.label<m[2])w.label=m[2],w.ops.push(x);else{m[2]&&w.ops.pop();w.trys.pop();continue}}x=g.call(f,w)}catch(v){x=[6,v],h=0}finally{p=m=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([t,k])}}var p,h,m,l,w={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return l={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&
(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(a,"__esModule",{value:!0});a.invokePurchaseUIForAEM=void 0;var n=r(851),b=r(3862),c=r(6431),d=r(7688);a.invokePurchaseUIForAEM=function(f,g){return u(this,void 0,void 0,function(){var e,p,h,m,l,w;return q(this,function(t){switch(t.label){case 0:e=(0,b.aadSignInRequired)(),p=(0,b.userInfo)(),h=(0,b.isBusinessStore)(),m=(0,b.currentRouteName)(),(0,b.addCssTag)(),t.label=1;case 1:return t.trys.push([1,4,,5]),f&&(0,b.isIFrame)(f)?((0,
b.showLoadingOnAEMPage)(),(0,c.handlePostMessage)(f,b.clearTimeOuts),(0,b.routeToSignInForAnonymousUserOnBusinessPage)(p),(0,d.captureInfoTelemetry)((0,b.telemetryTagNameByRoute)(m),m,"/"+m),[4,(0,n.invokePurchaseUIInFrame)(f,(0,b.constructPurchaseUIPayload)(p,h),e?"aad":null!=g?g:void 0)]):[3,3];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:return l=t.sent(),-1<(null==(w=l.message)?void 0:w.indexOf("Authentication token is missing"))?(0,b.executeChallengeUser)():(0,b.goToCartPage)(f),[3,5];
case 5:return(0,b.hideLoadingOnAEMPage)(),[2]}})})}},2469:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.executeChallengeUser=void 0;var u,q=r(1884),n=0;a.executeChallengeUser=function(){(0,q.challengeUser)()||(u=setInterval(b,100))};var b=function(){n++;(0,q.challengeUser)()?clearInterval(u):(console.error("Challenge user not successful for count: "+n),100<n&&(clearInterval(u),console.error("Challenge user failed")))}},5936:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});
a.addCssTag=a.MaximizeUhf=a.MinimizeUhf=void 0;a.MinimizeUhf=function(){var r=document.querySelectorAll("div.js-global-head\x3ediv\x3ediv.c-show-pipe.x-hidden-vp-mobile-st"),u=document.querySelectorAll("div.js-global-head\x3ediv\x3ediv.c-uhfh-actions"),q=document.querySelectorAll("div.js-global-head\x3ediv\x3enav"),n=document.querySelectorAll(".universalfooter\x3ediv\x3ediv\x3ediv\x3efooter\x3enav"),b=document.querySelectorAll("button.glyph-global-nav-button"),c=document.querySelectorAll("div.cat-logo-button-cont");
null==r||r.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&d.classList.add("hidden-me")});null==u||u.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&d.classList.add("hidden-me")});null==q||q.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&d.classList.add("hidden-me")});null==n||n.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&d.classList.add("hidden-me")});null==b||b.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&
d.classList.add("hidden-me")});null==c||c.forEach(function(d){d.classList&&!d.classList.contains("hidden-me")&&d.classList.add("hidden-me")})};a.MaximizeUhf=function(){var r=document.querySelectorAll("div.js-global-head\x3ediv\x3ediv.c-show-pipe.x-hidden-vp-mobile-st"),u=document.querySelectorAll("div.js-global-head\x3ediv\x3ediv.c-uhfh-actions"),q=document.querySelectorAll("div.js-global-head\x3ediv\x3enav"),n=document.querySelectorAll(".universalfooter\x3ediv\x3ediv\x3ediv\x3efooter\x3enav"),b=
document.querySelectorAll("button.glyph-global-nav-button"),c=document.querySelectorAll("div.cat-logo-button-cont");null==r||r.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")});null==u||u.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")});null==q||q.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")});
null==n||n.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")});null==b||b.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")});null==c||c.forEach(function(d){var f;(null===(f=d.classList)||void 0===f?0:f.contains("hidden-me"))&&d.classList.remove("hidden-me")})};a.addCssTag=function(){var r=document.head||document.getElementsByTagName("head")[0],u=document.createElement("style");
u.type="text/css";u.styleSheet?u.styleSheet.cssText=".hidden-me { display: none !important; }":u.appendChild(document.createTextNode(".hidden-me { display: none !important; }"));r.appendChild(u)}},1884:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.routeToSignInForAnonymousUserOnBusinessPage=a.getAuthToken=a.getLogInURL=a.challengeUser=a.getCorpAccessToken=a.setCorpAccessToken=void 0;var u=r(7688),q=r(8173),n=r(2929),b;a.setCorpAccessToken=function(c){c&&(b=c)};a.getCorpAccessToken=
function(){return b};a.challengeUser=function(){var c,d,f,g,e,p,h=(0,n.isBusinessStore)(),m=null===(f=null===(d=null===(c=window)||void 0===c?void 0:c.CascadeAuth)||void 0===d?void 0:d.API)||void 0===f?void 0:f.challengeUser;c=null===(p=null===(e=null===(g=window)||void 0===g?void 0:g.CascadeAuth)||void 0===e?void 0:e.API)||void 0===p?void 0:p.invokeSilentAuth;return!(!m||!c||(h?c():m(),0))};a.getLogInURL=function(){var c,d;return null===(d=null===(c=window)||void 0===c?void 0:c.CascadeAuth.API.getConfig())||
void 0===d?void 0:d.baseUrls};a.getAuthToken=function(c,d,f){return d?c?f?d.AuthTicketPx:d.AuthTicketEx:d.AuthTicket:""};a.routeToSignInForAnonymousUserOnBusinessPage=function(c){(0,n.isBusinessStoreByURL)()&&!c&&((0,u.captureInfoTelemetry)(u.INVOKE_USER_LOGIN,q.cartPageName,q.cartRoute),(0,a.challengeUser)())}},8173:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.purchaseUIMicrosoftHost="https://www.microsoft.com";a.purchaseUIMicrosoftPath="/store/purchase/purchaseui";a.cartRoute=
"/cart";a.checkoutRoute="/checkout";a.livePersonHost="https://publisher.liveperson.net";a.smartErrorPageUrl="https://www.microsoft.com/library/errorpages/smarterror.aspx?correlationId\x3d";a.purchaseUITimeOutValue=2E4;a.cartPageName="Cart";a.checkoutPageName="Checkout";a.flightSwitchString="setswitch";a.prodDomainName="www.microsoft.com";a.businessCssOverride="CommercialStore";a.webClientType="UniversalWebStore.Cart";a.webCanvasType="web";a.keepShoppingUrlValue="https://www.microsoft.com/store/b/home";
a.experimentQueryParam="fdhead";a.experimentCookieName="X-FD-FEATURES";a.minimalUHFRoutes=["checkout","guest-checkout"]},1399:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.setValueInCookie=a.getValueFromCookie=void 0;var u=r(8173);a.getValueFromCookie=function(q){var n,b="; "+document.cookie;q=null==b?void 0:b.split("; "+q+"\x3d");if(1<q.length)return null===(n=q.pop())||void 0===n?void 0:n.split(";").shift()};a.setValueInCookie=function(q,n){window.location.hostname===u.prodDomainName?
document.cookie=q+"\x3d"+n+";domain\x3d.www.microsoft.com;path\x3d/":document.cookie=q+"\x3d"+n+";path\x3d/"}},9733:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.enabledExperiments=a.getExperimentsFromCookie=a.convertExperimentForPurchaseUI=void 0;var u=r(1399),q=r(8173);a.convertExperimentForPurchaseUI=function(n){return 0<n.length?n.map(function(b){return"feature."+b}):[]};a.getExperimentsFromCookie=function(){var n,b=(0,u.getValueFromCookie)(q.experimentCookieName)||"";return-1<
(null==b?void 0:b.indexOf("ids\x3d"))&&(b=null===(n=b.split("ids\x3d")[1])||void 0===n?void 0:n.split(","),0<(null==b?void 0:b.length))?b.map(function(c){return"feature."+c}):[]};a.enabledExperiments=function(){var n,b,c,d,f=(c=null==(b=null===(n=window.location.search)||void 0===n?void 0:n.split("?")[1])?void 0:b.split("\x26"),d=[],null==c||c.filter(function(g){var e;g=null==g?void 0:g.split("\x3d");(null===(e=g[0])||void 0===e?void 0:e.toLocaleLowerCase())===q.experimentQueryParam&&g[1]&&0<g[1].length&&
(e=decodeURIComponent(g[1]),null==e||e.split(",").forEach(function(p){return d.push(p)}))}),d);n=(0,a.convertExperimentForPurchaseUI)(f);return 0<(null==n?void 0:n.length)?((0,u.setValueInCookie)(q.experimentCookieName,"ids\x3d"+f.join(",")),n):(0,a.getExperimentsFromCookie)()}},4202:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.hasPPEFlight=a.getFlights=a.aadSignInRequired=void 0;var u=r(1121),q=r(1884),n=r(8173),b=r(1399),c=function(){var f,g=(0,b.getValueFromCookie)(n.flightSwitchString);
return g?null===(f=decodeURIComponent(g))||void 0===f?void 0:f.split(","):[]},d=function(){var f,g,e=null===(f=window.location.search)||void 0===f?void 0:f.split("?")[1];f=null==e?void 0:e.split("\x26");var p="";return null==f||f.filter(function(h){var m;h=null==h?void 0:h.split("\x3d");(null===(m=h[0])||void 0===m?void 0:m.toLocaleLowerCase())===n.flightSwitchString&&(p=decodeURIComponent(h[1]),(0,b.setValueInCookie)(n.flightSwitchString,p))}),""===p?[]:null!==(g=null==p?void 0:p.split(","))&&void 0!==
g?g:[]};a.aadSignInRequired=function(){var f,g;return!(0,q.getCorpAccessToken)()&&(0<(null===(f=d())||void 0===f?void 0:f.length)||0<(null===(g=c())||void 0===g?void 0:g.length))};a.getFlights=function(){var f=[],g=c(),e=d();g=0<(null==e?void 0:e.length)?e:g;return null==g||g.forEach(function(p){p&&0<(null==p?void 0:p.length)&&(null==p?0:p.includes("sc_"))&&(null==p||!p.includes(":0"))&&f.push(null==p?void 0:p.replace(/:1/g,""))}),f};a.hasPPEFlight=function(f){return 0<(null==f?void 0:f.length)&&
f.map(function(g){return g.toLowerCase()}).includes(u.ppeFlightName)}},3862:function(y,a,r){var u=this&&this.__createBinding||(Object.create?function(q,n,b,c){void 0===c&&(c=b);Object.defineProperty(q,c,{enumerable:!0,get:function(){return n[b]}})}:function(q,n,b,c){void 0===c&&(c=b);q[c]=n[b]});y=this&&this.__exportStar||function(q,n){for(var b in q)"default"===b||Object.prototype.hasOwnProperty.call(n,b)||u(n,q,b)};Object.defineProperty(a,"__esModule",{value:!0});y(r(4345),a);y(r(8173),a);y(r(1884),
a);y(r(4202),a);y(r(2929),a);y(r(5936),a);y(r(2595),a);y(r(9733),a);y(r(2469),a);y(r(2942),a)},2595:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.openURLOnHostPage=a.updateHostPageURLPath=a.invokePurchaseByUrl=a.goToCheckoutPage=a.goToCartPage=a.addOrUpdateQSPToURL=void 0;var u=r(7688),q=r(3862),n=r(5708),b="";a.addOrUpdateQSPToURL=function(c){if(null==c?0:c.includes("\x3d")){var d=new URL(window.location.href);window.history.replaceState({},"",d.search?d.href+"\x26"+c:d.href+
"?"+c)}};a.goToCartPage=function(c){(0,u.captureInfoTelemetry)(u.INVOKE_CART,q.cartPageName,q.cartRoute);(0,q.updateURLRoute)(q.cartRoute);(0,n.invokePurchaseUIForAEM)(c,"cart")};a.goToCheckoutPage=function(c){(0,u.captureInfoTelemetry)(u.INVOKE_CHECKOUT,q.checkoutPageName,q.checkoutRoute);(0,q.updateURLRoute)(q.checkoutRoute);(0,n.invokePurchaseUIForAEM)(c,"checkout")};a.invokePurchaseByUrl=function(c){(0,u.captureInfoTelemetry)(u.INVOKE_CART,q.cartPageName,q.cartRoute);(0,n.invokePurchaseUIForAEM)(c)};
a.updateHostPageURLPath=function(c){c!==b&&((0,u.captureInfoTelemetry)(u.ROUTE_CHANGE,(0,q.currentRouteName)(),c),(0,q.updateHostPageRoute)(c),(0,q.updateUHFState)(c),b=c)};a.openURLOnHostPage=function(c,d){(0,u.captureInfoTelemetry)(u.OPEN_URL,(0,q.currentRouteName)(),c);window.open(c,d)}},4345:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.constructPurchaseUIPayload=void 0;var u=r(8399),q=r(1884),n=r(8173),b=r(1399),c=r(9733),d=r(4202),f=r(2929),g=r(6813);a.constructPurchaseUIPayload=
function(e,p,h){var m,l,w,t,k,x,v,A,B,z,D,H,I,J,N=null===(m=window)||void 0===m?void 0:m.mscv;m=null!==(A=null!==(k=null===(t=null===(w=null===(l=window)||void 0===l?void 0:l.location)||void 0===w?void 0:w.href)||void 0===t?void 0:t.split("/")[3])&&void 0!==k?k:null===(v=null===(x=window)||void 0===x?void 0:x._TMDL)||void 0===v?void 0:v.ll)&&void 0!==A?A:"en-US";l=null!==(B=(0,f.getMarketFromLocale)(m))&&void 0!==B?B:"US";B=(0,q.getCorpAccessToken)()?(0,d.getFlights)():[];w=null===(z=(0,f.fetchGPCDataSharingOptInValue)())||
void 0===z||z;z=(0,c.enabledExperiments)();return{authToken:p?"":null!==(D=(0,q.getAuthToken)(p,e))&&void 0!==D?D:"",bearerToken:p&&null!==(H=(0,q.getAuthToken)(p,e))&&void 0!==H?H:"",market:l,cV:N,locale:m,isHosted:!0,canvasType:n.webCanvasType,clientType:n.webClientType,muid:(0,b.getValueFromCookie)("MUID"),alternativeMuid:(0,b.getValueFromCookie)("cartMuid"),pageFormat:"full",flights:B,experiments:z,corpAccessToken:(0,q.getCorpAccessToken)(),orderId:h,billingAccountId:p?(0,b.getValueFromCookie)("BillingAcctId"):
"",pidlBearerToken:p&&null!==(I=(0,q.getAuthToken)(p,e,!0))&&void 0!==I?I:"",clientHandleUrl:!0,cssOverride:(0,f.addCSSOverrideForBusiness)(),GPC_DataSharingOptIn:w,queryStringParams:null===(J=window.location.search)||void 0===J?void 0:J.slice(1),keepShoppingUrl:n.keepShoppingUrlValue,timeToInvokeIframe:(0,u.getTimeToInvokeMark)("invokePurchaseUIForAEM"),sdkVersion:g.LIB_VERSION,postCartCountToParent:!0,selectEnv:(0,d.hasPPEFlight)(B)?"ppe":void 0}}},2942:function(y,a){Object.defineProperty(a,"__esModule",
{value:!0});a.hideLoadingOnAEMPage=a.showLoadingOnAEMPage=void 0;a.showLoadingOnAEMPage=function(){var r,u,q=document.getElementsByName("purchase-loading")?document.getElementsByName("purchase-loading")[0]:null;(null===(r=null==q?void 0:q.classList)||void 0===r?0:r.contains("hide-loader"))&&(null===(u=null==q?void 0:q.classList)||void 0===u||u.remove("hide-loader"))};a.hideLoadingOnAEMPage=function(){var r=document.getElementsByName("purchase-loading")?document.getElementsByName("purchase-loading")[0]:
null;(null==r?0:r.classList)&&!r.classList.contains("hide-loader")&&r.classList.add("hide-loader")}},2929:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.fetchGPCDataSharingOptInValue=a.addCSSOverrideForBusiness=a.telemetryTagNameByRoute=a.currentRouteName=a.updateUHFState=a.clearTimeOuts=a.handleTimeOutFailure=a.updateURLRoute=a.updateCheckoutURL=a.updateHostPageRoute=a.isBusinessStoreByURL=a.isBusinessStore=a.getCurrentPageName=a.userInfo=a.getMarketFromLocale=a.createInput=a.isIFrame=
void 0;var u=r(7688),q=r(5936),n=r(8173),b=r(1399);a.isIFrame=function(c){return null!==c&&"IFRAME"===c.tagName};a.createInput=function(c,d,f){var g=document.createElement("input");return g.name=c,g.type="hidden",g.value=d?JSON.stringify(d):null!=f?f:"",g};a.getMarketFromLocale=function(c){c=c.split("-");return c[c.length-1]};a.userInfo=function(){var c;return null===(c=window)||void 0===c?void 0:c.msauth};a.getCurrentPageName=function(){var c;return(null===(c=window.location.pathname)||void 0===
c?0:c.includes(n.cartRoute))?n.cartPageName:n.checkoutPageName};a.isBusinessStore=function(){var c=(0,a.userInfo)();return"aad"===(null==c?void 0:c.Type)};a.isBusinessStoreByURL=function(){var c=window.location.href;return null==c?void 0:c.includes("/business/")};a.updateHostPageRoute=function(c){var d,f=new URL(window.location.href),g=null===(d=null==f?void 0:f.pathname)||void 0===d?void 0:d.split("/");g[g.length-1]=c;c=g.join("/");f.pathname=c;history.pushState({},"",f.toString())};a.updateCheckoutURL=
function(){var c,d,f,g=window.location.href;g=null==g?void 0:g.split("?");var e=(null===(f=null===(d=null===(c=g[0])||void 0===c?void 0:c.split("/"))||void 0===d?void 0:d.slice(0,-1))||void 0===f?void 0:f.join("/"))+n.checkoutRoute;1<(null==g?void 0:g.length)&&(e=e+"?"+g[1]);history.pushState({},"",e)};a.updateURLRoute=function(c){var d,f,g,e=window.location.href;e=null==e?void 0:e.split("?");c=(null===(g=null===(f=null===(d=e[0])||void 0===d?void 0:d.split("/"))||void 0===f?void 0:f.slice(0,-1))||
void 0===g?void 0:g.join("/"))+c;1<(null==e?void 0:e.length)&&(c=c+"?"+e[1]);history.pushState({},"",c)};a.handleTimeOutFailure=function(){var c,d=null===(c=window)||void 0===c?void 0:c.mscv;window.location.href=""+n.smartErrorPageUrl+d};a.clearTimeOuts=function(c){clearTimeout(c)};a.updateUHFState=function(c){n.minimalUHFRoutes.includes(c)?(0,q.MinimizeUhf)():(0,q.MaximizeUhf)()};a.currentRouteName=function(){try{var c=window.location.pathname.split("/"),d=c[c.length-1];return d.indexOf(".html")&&
(d=d.replace(".html","")),d}catch(f){return""}};a.telemetryTagNameByRoute=function(c){switch(c){case "cart":return u.INVOKE_CART;case "checkout":return u.INVOKE_CHECKOUT;case "aad":return u.INVOKE_USER_LOGIN;case "guest-order-lookup":return u.INVOKE_GUEST_ORDER_LOOKUP;case "commercial-checkout":return u.INVOKE_COMMERCIAL_CHECKOUT}return""};a.addCSSOverrideForBusiness=function(){var c=window.location.href;return(0,a.isBusinessStore)()||(null==c?0:c.includes("/business/"))?n.businessCssOverride:""};
a.fetchGPCDataSharingOptInValue=function(){var c,d;if(d=!(null===(c=navigator)||void 0===c?0:c.globalPrivacyControl))try{d=1!=Number((0,b.getValueFromCookie)("3PAdsOptOut"))}catch(f){d=!0}return d}},6431:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.handlePostMessage=void 0;var u=r(1121),q=r(5708),n=r(3862),b=r(7688);a.handlePostMessage=function(d,f){window.addEventListener("message",function(g){var e;g.origin===n.purchaseUIMicrosoftHost&&c(d,f,g);g.origin===n.livePersonHost&&
"ready"===g.data.message&&(0,n.isIFrame)(d)&&((0,b.captureInfoTelemetry)(b.LIVE_PERSON_READY,n.cartPageName,n.cartRoute),null===(e=null==d?void 0:d.contentWindow)||void 0===e||e.postMessage(g.data,"*"))})};var c=function(d,f,g){var e,p,h=null===(e=g.data)||void 0===e?void 0:e.message;if(h)return e={aadSignInResult:function(){var m=g.data.accessToken;(0,n.setCorpAccessToken)(m);(0,n.invokePurchaseByUrl)(d)},aadSignInRequired:function(){(0,q.invokePurchaseUIForAEM)(d,"aad")},checkout:function(){(0,
n.goToCheckoutPage)(d)},done:function(){if("cancel"===g.data.status){var m=g.data.parameters;m&&(0,n.addOrUpdateQSPToURL)(m);(0,n.goToCartPage)(d)}},signIn:function(){(0,b.captureInfoTelemetry)(b.INVOKE_USER_LOGIN,(0,n.getLogInURL)(),n.cartRoute);(0,n.executeChallengeUser)()},ready:function(){(0,b.captureInfoTelemetry)(b.PURCHASE_READY,n.cartPageName,n.cartRoute);f()},routeChange:function(){var m=g.data.route;m&&(0,n.updateHostPageURLPath)(m)},titleChange:function(){var m=g.data.title;(0,b.captureInfoTelemetry)(b.TITLE_CHANGE,
(0,n.currentRouteName)(),m);document.title=m},openUrl:function(){var m,l,w=g.data.url,t=u.windowTargetCurrent===(null===(l=null===(m=g.data.targetWindow)||void 0===m?void 0:m.toString())||void 0===l?void 0:l.toLowerCase())?"_self":"_blank";(0,n.openURLOnHostPage)(w,t)},resize:function(){var m=Math.ceil(g.data.height);0<m&&(d.height=m.toString())},updateQueryString:function(){window.history.replaceState({},"",""+window.location.origin+window.location.pathname+"?"+g.data.queryString)}},null===(p=e[h])||
void 0===p?void 0:p.call(e)}},2011:function(y,a){var r;Object.defineProperty(a,"__esModule",{value:!0});a.LogSeverityLevel=void 0;(r=a.LogSeverityLevel||(a.LogSeverityLevel={}))[r.Verbose=0]="Verbose";r[r.Information=1]="Information";r[r.Warning=2]="Warning";r[r.Error=3]="Error";r[r.Critical=4]="Critical"},9651:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.INVOKE_CART="[SC_InvokeCart]";a.INVOKE_CHECKOUT="[SC_InvokeCheckout]";a.INVOKE_USER_LOGIN="[SC_InvokeUserLogin]";a.INVOKE_GUEST_ORDER_LOOKUP=
"[SC_InvokeGuestOrderLookup]";a.INVOKE_COMMERCIAL_CHECKOUT="[SC_InvokeCommercialCheckout]";a.PURCHASE_READY="[SC_PurchaseReady]";a.LIVE_PERSON_READY="[SC_LivePersonReady]";a.ROUTE_CHANGE="[SC_RouteChange]";a.TITLE_CHANGE="[SC_TitleChange]";a.OPEN_URL="[SC_OpenUrl]"},7688:function(y,a,r){var u=this&&this.__createBinding||(Object.create?function(q,n,b,c){void 0===c&&(c=b);Object.defineProperty(q,c,{enumerable:!0,get:function(){return n[b]}})}:function(q,n,b,c){void 0===c&&(c=b);q[c]=n[b]});y=this&&
this.__exportStar||function(q,n){for(var b in q)"default"===b||Object.prototype.hasOwnProperty.call(n,b)||u(n,q,b)};Object.defineProperty(a,"__esModule",{value:!0});y(r(4644),a);y(r(9651),a)},4644:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.TelemetryLogger=a.captureInfoTelemetry=void 0;var u=r(2011);a.captureInfoTelemetry=function(n,b,c,d,f){var g;b={pageName:b,pageUrl:c,timeToLoad:null!=d?d:Date.now(),cV:null!=f?f:null===(g=window)||void 0===g?void 0:g.mscv};q.trace(n,u.LogSeverityLevel.Information,
b)};var q=function(){function n(){}return n.trace=function(b,c,d){var f,g;null===(g=null===(f=null===window||void 0===window?void 0:window.telemetry)||void 0===f?void 0:f.telemetryLog)||void 0===g||g.trace(b,c,d)},n.event=function(b,c){var d,f;null===(f=null===(d=null===window||void 0===window?void 0:window.telemetry)||void 0===d?void 0:d.telemetryLog)||void 0===f||f.event(b,c)},n.error=function(b,c){var d,f;null===(f=null===(d=null===window||void 0===window?void 0:window.telemetry)||void 0===d?void 0:
d.telemetryLog)||void 0===f||f.error(b,c)},n.dependency=function(b,c,d,f,g,e){var p,h;null===(h=null===(p=null===window||void 0===window?void 0:window.telemetry)||void 0===p?void 0:p.telemetryLog)||void 0===h||h.dependency(b,c,d,f,g,e)},n}();a.TelemetryLogger=q},1121:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.TARGET_ORIGIN="https://www.microsoft.com";a.BASE_PURCHASEUI_URL="/store/purchase/purchaseui/";a.BASE_BUYNOWUI_URL="/store/purchase/buynowui";a.PPE_PURCHASEUI_URL="/store/purchase/purchaseui-ppe/";
a.PPE_BUYNOWUI_URL="/store/purchase/buynowui-ppe";a.BUYNOW_PREFETCH_URL="https://www.microsoft.com/store/purchase/buynowui/prefetch/buynow";a.REDEEMNOW_PREFETCH_URL="https://www.microsoft.com/store/purchase/buynowui/prefetch/redeemnow";a.windowTargetCurrent="current";a.GPC_DataSharingOptInKey="GPC_DataSharingOptIn";a.prefetchURLTemplate="https://www.microsoft.com/store/purchase/{0}/prefetch/{1}";a.purchaseUIAppName="purchaseui";a.buyNowUIAppName="buynowui";a.ppeFlightName="sc_cartppe";a.appRoutes=
{cart:"cart",checkout:"checkout",buyNow:"buynow",redeem:"redeem",deviceRepair:"device-repair",guestOrderLookup:"guest-order-lookup",aadSignIn:"aad-signin",commercialCheckout:"commercial-checkout"}},2747:function(y,a,r){var u=this&&this.__awaiter||function(d,f,g,e){return new (g||(g=Promise))(function(p,h){function m(t){try{w(e.next(t))}catch(k){h(k)}}function l(t){try{w(e.throw(t))}catch(k){h(k)}}function w(t){var k;t.done?p(t.value):(k=t.value,k instanceof g?k:new g(function(x){x(k)})).then(m,l)}
w((e=e.apply(d,f||[])).next())})},q=this&&this.__generator||function(d,f){function g(w){return function(t){return function(k){if(e)throw new TypeError("Generator is already executing.");for(;l;)try{if(e=1,p&&(h=2&k[0]?p.return:k[0]?p.throw||((h=p.return)&&h.call(p),0):p.next)&&!(h=h.call(p,k[1])).done)return h;switch(p=0,h&&(k=[2&k[0],h.value]),k[0]){case 0:case 1:h=k;break;case 4:return l.label++,{value:k[1],done:!1};case 5:l.label++;p=k[1];k=[0];continue;case 7:k=l.ops.pop();l.trys.pop();continue;
default:if(!((h=0<(h=l.trys).length&&h[h.length-1])||6!==k[0]&&2!==k[0])){l=0;continue}if(3===k[0]&&(!h||k[1]>h[0]&&k[1]<h[3]))l.label=k[1];else if(6===k[0]&&l.label<h[1])l.label=h[1],h=k;else if(h&&l.label<h[2])l.label=h[2],l.ops.push(k);else{h[2]&&l.ops.pop();l.trys.pop();continue}}k=f.call(d,l)}catch(x){k=[6,x],p=0}finally{e=h=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([w,t])}}var e,p,h,m,l={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return m=
{next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m};Object.defineProperty(a,"__esModule",{value:!0});a.invokeOrderLookUpInFrame=void 0;var n=r(8399),b=r(1689),c=r(6813);a.invokeOrderLookUpInFrame=function(d,f){var g,e;return u(this,void 0,void 0,function(){var p;return q(this,function(h){switch(h.label){case 0:if(!d.name)throw Error('purchase-sdk: target iframe must have unique "name" attribute set');return(p=document.createElement("form")).target=
d.name,p.action=(0,b.constructOrderLookUpURl)(f),p.method="post",(0,b.createInputForCheckout)(p,{market:f.market,cV:encodeURIComponent(f.cV),locale:f.locale,clientType:f.clientType,layout:f.layout,cssOverride:f.cssOverride,theme:f.theme,muid:f.muid,pageFormat:f.pageFormat||"full",authToken:f.authToken,xToken:f.xToken,isHosted:null===(g=f.isHosted)||void 0===g||g,canvasType:null!==(e=f.canvasType)&&void 0!==e?e:"web",alternativeMuid:f.alternativeMuid,flights:f.flights,corpAccessToken:f.corpAccessToken,
clientHandleUrl:!0,GPC_DataSharingOptIn:f.GPC_DataSharingOptIn,queryStringParams:f.queryStringParams,experiments:f.experiments,timeToInvokeIframe:(0,n.getTimeToInvokeMarkFromArgsOrNewMetric)("orderLookUpInvoke",f.timeToInvokeIframe),sdkVersion:c.LIB_VERSION}),d.appendChild(p),p.submit(),[4,(0,b.attachingMessageHandler)(p)];case 1:return h.sent(),[2,!0]}})})}},1689:function(y,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.constructOrderLookUpURl=a.createInputForCheckout=a.attachingMessageHandler=
void 0;var u=r(1737),q=r(5937),n=r(1121);a.attachingMessageHandler=function(b){return new Promise(function(c){return window.addEventListener("message",function(d){d.origin===n.TARGET_ORIGIN&&("ReactPurchaseReadyToRender"===d.data&&c(),b&&b.remove())},!0)})};a.createInputForCheckout=function(b,c){Object.keys(c).forEach(function(d){if(d&&c[d])if("authToken"===d)b.appendChild((0,q.createInput)("msaTicket",void 0,c.authToken));else if("flights"===d)(0,q.createInputForArray)(b,"flights",c.flights);else if("experiments"===
d)(0,q.createInputForArray)(b,"experiments",c.experiments);else{var f=c[d];b.appendChild((0,q.createInput)(d,void 0,f))}else d&&d===n.GPC_DataSharingOptInKey&&(f=c[d],b.appendChild((0,q.createInput)(d,void 0,f)))})};a.constructOrderLookUpURl=function(b){var c=""+n.TARGET_ORIGIN+(0,u.purchaseUIUrlPath)(b,b.flights)+n.appRoutes.guestOrderLookup;if(!b.clientType)throw Error("purchase-sdk: clientType is missing !!!");return c=c+"?client\x3d"+b.clientType,(0,q.addingQueryParams)(c,b.queryStringParams)}},
851:function(y,a,r){var u=this&&this.__createBinding||(Object.create?function(h,m,l,w){void 0===w&&(w=l);Object.defineProperty(h,w,{enumerable:!0,get:function(){return m[l]}})}:function(h,m,l,w){void 0===w&&(w=l);h[w]=m[l]}),q=this&&this.__setModuleDefault||(Object.create?function(h,m){Object.defineProperty(h,"default",{enumerable:!0,value:m})}:function(h,m){h.default=m});y=this&&this.__importStar||function(h){if(h&&h.__esModule)return h;var m={};if(null!=h)for(var l in h)"default"!==l&&Object.prototype.hasOwnProperty.call(h,
l)&&u(m,h,l);return q(m,h),m};var n=this&&this.__awaiter||function(h,m,l,w){return new (l||(l=Promise))(function(t,k){function x(B){try{A(w.next(B))}catch(z){k(z)}}function v(B){try{A(w.throw(B))}catch(z){k(z)}}function A(B){var z;B.done?t(B.value):(z=B.value,z instanceof l?z:new l(function(D){D(z)})).then(x,v)}A((w=w.apply(h,m||[])).next())})},b=this&&this.__generator||function(h,m){function l(A){return function(B){return function(z){if(w)throw new TypeError("Generator is already executing.");for(;v;)try{if(w=
1,t&&(k=2&z[0]?t.return:z[0]?t.throw||((k=t.return)&&k.call(t),0):t.next)&&!(k=k.call(t,z[1])).done)return k;switch(t=0,k&&(z=[2&z[0],k.value]),z[0]){case 0:case 1:k=z;break;case 4:return v.label++,{value:z[1],done:!1};case 5:v.label++;t=z[1];z=[0];continue;case 7:z=v.ops.pop();v.trys.pop();continue;default:if(!((k=0<(k=v.trys).length&&k[k.length-1])||6!==z[0]&&2!==z[0])){v=0;continue}if(3===z[0]&&(!k||z[1]>k[0]&&z[1]<k[3]))v.label=z[1];else if(6===z[0]&&v.label<k[1])v.label=k[1],k=z;else if(k&&v.label<
k[2])v.label=k[2],v.ops.push(z);else{k[2]&&v.ops.pop();v.trys.pop();continue}}z=m.call(h,v)}catch(D){z=[6,D],t=0}finally{w=k=0}if(5&z[0])throw z[1];return{value:z[0]?z[1]:void 0,done:!0}}([A,B])}}var w,t,k,x,v={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return x={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(x[Symbol.iterator]=function(){return this}),x};Object.defineProperty(a,"__esModule",{value:!0});a.invokePurchaseUIInFrame=void 0;var c=r(5465),d=
r(5659),f=r(6063),g=r(3862),e=r(2747),p=y(r(1228));a.invokePurchaseUIInFrame=function(h,m,l){return n(this,void 0,void 0,function(){var w,t,k;return b(this,function(x){switch(x.label){case 0:if(!h)throw Error("Frame is not defined");if(!m)throw Error("Args is not defined");switch((w=l)||(t=window.location.pathname,k=t.split("/"),(w=k[k.length-1]).indexOf(".html")&&(w=w.replace(".html",""))),w){case "cart":return[3,1];case "checkout":return[3,3];case "aad":return[3,5];case "guest-order-lookup":return[3,
7];case "commercial-checkout":return[3,9]}return[3,11];case 1:return[4,(0,c.invokeCartInFrame)(h,m)];case 2:return x.sent(),(0,g.MaximizeUhf)(),[2];case 3:return[4,(0,d.invokeCheckoutInFrame)(h,m)];case 4:return x.sent(),(0,g.MinimizeUhf)(),[2];case 5:return[4,(0,f.invokeAADSignInInFrame)(h,m)];case 6:return x.sent(),(0,g.MaximizeUhf)(),[2];case 7:return[4,(0,e.invokeOrderLookUpInFrame)(h,m)];case 8:return x.sent(),(0,g.MaximizeUhf)(),[2];case 9:return[4,p.invokeCheckoutInFrame(h,m)];case 10:return x.sent(),
(0,g.MinimizeUhf)(),[2];case 11:return[2]}})})}},6813:function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.LIB_VERSION="VERSION_PLACEHOLDER"}},G={};var O=E(5708);E(5465);E(5659);E(6063);(C=K||(K={}))[C.Verbose=0]="Verbose";C[C.Information=1]="Information";C[C.Warning=2]="Warning";C[C.Error=3]="Error";C[C.Critical=4]="Critical";(F=document.getElementById("purchase-frame"))&&null!==(L=F)&&"IFRAME"===L.tagName&&(F.setAttribute("key",Math.random().toString()),(0,O.invokePurchaseUIForAEM)(F))}();